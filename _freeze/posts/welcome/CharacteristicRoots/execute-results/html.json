{
  "hash": "6a429fb9597c00ffe794d2f91e0b642c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"A Bit More on Characteristic Roots\"\nauthor: \"Robert W. Walker\"\ndate: \"07/23/2025\"\ncategories: [time series, code, analysis]\nimage: \"thumbnail.png\"\n---\n\nI was mistaken about one thing that I said yesterday and I need to correct it.  There are stability conditions for the `ar` and `ma` processes that revolve around the roots of the characteristic equations.  The so-called stationarity and invertability conditions.  They are implemented by default in R's arima package but they can be checked with relative ease in both stata and R.\n\nIn particular, having estimated an ar process ar(p), the characteristic equations in the slides give a $p^{th}$ order polynomial that we can solve for the charateristic roots.  There is an invertability condition for an ma(q) that gives a $q^{th}$ order polynomial.  After estimating an ARIMA(p,d,q) model, they can be easily checked.  In both cases, the complex roots should lie outside the unit circle.  We more frequently examine the inverse roots and ask whether or not they are **inside** the unit circle.\n\nTaking the British government popularity data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(fpp3)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'tsibble':\n  method               from \n  as_tibble.grouped_df dplyr\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching packages ──────────────────────────────────────────── fpp3 1.0.1 ──\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n✔ tibble      3.3.0     ✔ tsibble     1.1.6\n✔ dplyr       1.1.4     ✔ tsibbledata 0.4.1\n✔ tidyr       1.3.1     ✔ feasts      0.4.1\n✔ lubridate   1.9.4     ✔ fable       0.4.1\n✔ ggplot2     3.5.2     \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Conflicts ───────────────────────────────────────────────── fpp3_conflicts ──\n✖ lubridate::date()    masks base::date()\n✖ dplyr::filter()      masks stats::filter()\n✖ tsibble::intersect() masks base::intersect()\n✖ tsibble::interval()  masks lubridate::interval()\n✖ dplyr::lag()         masks stats::lag()\n✖ tsibble::setdiff()   masks base::setdiff()\n✖ tsibble::union()     masks base::union()\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(haven)\nbr7983 <- read_dta(url(\"https://github.com/robertwwalker/Essex-Data/raw/main/br7983.dta\")) %>% \n  mutate(month = as.character(month)) %>% \n  mutate(month = paste0(\"19\",month, sep=\"\")) %>% \n  mutate(date = yearmonth(month, format=\"%Y%m\"))\nbr7983 <- br7983 %>% as_tsibble(index=date) \nbr7983 %>% autoplot(govpopl) + hrbrthemes::theme_ipsum() + labs(y=\"logged Government Popularity\")\n```\n\n::: {.cell-output-display}\n![](CharacteristicRoots_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nThe best model seems to be ar(1) and sma(4).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod <- arima(br7983$govpopl, order = c(1,0,0), seasonal=list(order=c(0,0,1), period=4))\nmod\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\narima(x = br7983$govpopl, order = c(1, 0, 0), seasonal = list(order = c(0, 0, \n    1), period = 4))\n\nCoefficients:\n         ar1    sma1  intercept\n      0.8392  0.3350     3.4889\ns.e.  0.0760  0.1316     0.0997\n\nsigma^2 estimated as 0.008444:  log likelihood = 45.47,  aic = -82.95\n```\n\n\n:::\n\n```{.r .cell-code}\nacf(arima(br7983$govpopl, order = c(1,0,0), seasonal=list(order=c(0,0,1), period=4))$residuals)\n```\n\n::: {.cell-output-display}\n![](CharacteristicRoots_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(arima(br7983$govpopl, order = c(1,0,0), seasonal=list(order=c(0,0,1), period=4))$residuals)\n```\n\n::: {.cell-output-display}\n![](CharacteristicRoots_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\nWhite noise.  Parameters are all likely different from zero.  What about the characteristic roots?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nforecast::autoplot(mod)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'quantmod':\n  method            from\n  as.zoo.data.frame zoo \n```\n\n\n:::\n\n::: {.cell-output-display}\n![](CharacteristicRoots_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nNote that these are the inverse characteristic roots.  And all are inside the unit circle.  So this model is stationary and invertible.\n\nWhat about Stata?\n\n```\n. arima govpopl, ar(1) ma(4)\n\n(setting optimization to BHHH)\nIteration 0:  Log likelihood =  40.962134  \nIteration 1:  Log likelihood =  44.723724  \nIteration 2:  Log likelihood =  44.866662  \nIteration 3:  Log likelihood =  45.127431  \nIteration 4:  Log likelihood =  45.434671  \n(switching optimization to BFGS)\nIteration 5:  Log likelihood =  45.471498  \nIteration 6:  Log likelihood =  45.472428  \nIteration 7:  Log likelihood =  45.473906  \nIteration 8:  Log likelihood =  45.473963  \nIteration 9:  Log likelihood =  45.474094  \nIteration 10: Log likelihood =  45.474098  \n\nARIMA regression\n\nSample: 0 thru 47                               Number of obs     =         48\n                                                Wald chi2(2)      =      97.18\nLog likelihood = 45.4741                        Prob > chi2       =     0.0000\n\n------------------------------------------------------------------------------\n             |                 OPG\n     govpopl | Coefficient  std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\ngovpopl      |\n       _cons |   3.488899   .1376348    25.35   0.000      3.21914    3.758658\n-------------+----------------------------------------------------------------\nARMA         |\n          ar |\n         L1. |   .8391349   .0952577     8.81   0.000     .6524332    1.025837\n             |\n          ma |\n         L4. |   .3351339   .1690192     1.98   0.047     .0038624    .6664055\n-------------+----------------------------------------------------------------\n      /sigma |    .091893   .0090176    10.19   0.000     .0742189    .1095671\n------------------------------------------------------------------------------\nNote: The test of the variance against zero is one sided, and the two-sided\n      confidence interval is truncated at zero.\n\n. estat aroots\n\n   Eigenvalue stability condition\n  +----------------------------------------+\n  |        Eigenvalue        |   Modulus   |\n  |--------------------------+-------------|\n  |   .8391349               |   .839135   |\n  +----------------------------------------+\n   All the eigenvalues lie inside the unit circle.\n   AR parameters satisfy stability condition.\n\n   Eigenvalue stability condition\n  +----------------------------------------+\n  |        Eigenvalue        |   Modulus   |\n  |--------------------------+-------------|\n  |  -.5380091 +  .5380091i  |    .76086   |\n  |  -.5380091 -  .5380091i  |    .76086   |\n  |   .5380091 +  .5380091i  |    .76086   |\n  |   .5380091 -  .5380091i  |    .76086   |\n  +----------------------------------------+\n   All the eigenvalues lie inside the unit circle.\n   MA parameters satisfy invertibility condition.\n\n```\n\nNotice stata tells you how to interpret the result.\n\n![](CRootStata.png)\n\nAnd to reiterate, these conditions establish that either the MA(q) can be inverted to an infinite AR process with declining dependence through time or the AR(p) can be rewritten as an infinite order MA with each shock declining in weight through time.\n",
    "supporting": [
      "CharacteristicRoots_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}